=== TrustArc Mobile Consent SDK - Quick Reference ===

This knowledge base provides concise integration examples for TrustArc Mobile Consent SDK.

=== iOS Integration (Swift) ===

Initialize in AppDelegate:
```swift
import UIKit

@UIApplicationMain
class AppDelegate: UIResponder, UIApplicationDelegate {
    func application(_ application: UIApplication,
                    didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {
        TrustArcConsentImpl.shared.initialize()
        return true
    }
}
```

Show consent dialog:
```swift
class ViewController: UIViewController {
    @IBAction func showConsentTapped(_ sender: UIButton) {
        TrustArcConsentImpl.shared.openCm()
    }
}
```

Get consent data:
```swift
let consents = TrustArcConsentImpl.shared.getConsentData()
print("Consent data:", consents)
```

Requirements:
- iOS 12.0+
- Swift 5.0+
- Install via CocoaPods or Swift Package Manager

=== Android Integration (Kotlin) ===

Initialize in Application class:
```kotlin
import android.app.Application

class MyApplication : Application() {
    override fun onCreate() {
        super.onCreate()
        TrustArcConsentImpl.initialize(this)
    }
}
```

Show consent dialog:
```kotlin
class MainActivity : AppCompatActivity() {
    private fun showConsent() {
        TrustArcConsentImpl.openCm()
    }
}
```

Get consent data:
```kotlin
val consents = TrustArcConsentImpl.getConsentData()
Log.d("Consent", "Data: $consents")
```

Requirements:
- Android API 28+
- Kotlin required
- Add via Gradle dependency

=== React Native Integration (TypeScript) ===

Initialize in App.tsx:
```typescript
import React, { useEffect } from 'react';
import { TrustArcConsentImpl } from '@trustarc/trustarc-react-native-consent-sdk';

export default function App() {
  useEffect(() => {
    TrustArcConsentImpl.initialize();
  }, []);

  return <YourApp />;
}
```

Show consent dialog:
```typescript
import { Button } from 'react-native';

function ConsentButton() {
  const handlePress = () => {
    TrustArcConsentImpl.openCm();
  };

  return <Button title="Show Consent" onPress={handlePress} />;
}
```

Listen for consent changes:
```typescript
useEffect(() => {
  const unsubscribe = TrustArcConsentImpl.onConsentChange((data) => {
    console.log('Consent updated:', data);
  });

  return unsubscribe;
}, []);
```

Get consent data:
```typescript
const consents = await TrustArcConsentImpl.getConsentData();
console.log('Consents:', consents);
```

Requirements:
- React Native 0.60+
- Supports Expo and Bare Metal
- Install via npm/yarn

=== Flutter Integration (Dart) ===

Initialize in main:
```dart
import 'package:flutter/material.dart';
import 'package:trustarc_consent_sdk/trustarc_consent_impl.dart';

void main() {
  TrustArcConsentImpl.initialize();
  runApp(MyApp());
}
```

Show consent dialog:
```dart
class ConsentButton extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return ElevatedButton(
      onPressed: () {
        TrustArcConsentImpl.openCm();
      },
      child: Text('Show Consent'),
    );
  }
}
```

Get consent data:
```dart
final consents = await TrustArcConsentImpl.getConsentData();
print('Consent data: $consents');
```

Requirements:
- Flutter 2.0+
- Dart SDK 2.12+
- Add to pubspec.yaml

=== Common SDK Methods ===

All platforms support these three core methods:

1. initialize() - Sets up the SDK. Call once when app starts.
2. openCm() - Opens the consent management dialog.
3. getConsentData() - Returns current consent preferences.

=== Installation via CLI ===

Use the TrustArc CLI to automatically integrate:
```bash
sh -c "$(curl -fsSL https://raw.githubusercontent.com/trustarc-ci/trustarc-cli/refs/heads/main/install.sh)"
```

The CLI will:
- Auto-detect your platform
- Add SDK dependencies
- Generate boilerplate code
- Verify integration

=== Frequently Asked Questions ===

Q: When should I call initialize()?
A: Call it once when your app starts:
- iOS: In AppDelegate's didFinishLaunchingWithOptions
- Android: In Application's onCreate
- React Native: In App component's useEffect
- Flutter: In main() before runApp

Q: How do I show the consent dialog?
A: Call openCm() from anywhere in your app (button press, menu option, etc.)

Q: Can I check consent status without showing dialog?
A: Yes, use getConsentData() to retrieve current consent without showing UI

Q: What if user denies consent?
A: The SDK returns their preferences via getConsentData(). Your app should respect these preferences.

Q: How often should I show the consent dialog?
A: Only show it when required by law/regulations or when user explicitly requests it (e.g., Settings menu)

Q: Does the SDK work offline?
A: Initial setup requires internet. After that, it caches data locally.

Q: What data does the SDK collect?
A: It collects user consent preferences only. No personal information is collected without consent.

Q: Can I customize the consent dialog UI?
A: The dialog UI is managed by TrustArc. You can configure categories and text via TrustArc dashboard.

Q: Which platforms are supported?
A: iOS (12.0+), Android (API 28+), React Native (0.60+), Flutter (2.0+)

Q: Do I need a GitHub token?
A: Only for CLI installation. The token requires 'repo' and 'read:package' scopes.

=== Troubleshooting ===

"SDK not initialized"
→ Make sure you called initialize() before other SDK methods

"Consent dialog not showing"
→ Check network connection on first launch
→ Verify SDK initialization completed

"Build error: Module not found"
→ iOS: Run 'pod install' or verify Swift Package Manager
→ Android: Sync Gradle and verify repository configuration
→ React Native: Check .npmrc configuration

"Native module error" (React Native)
→ Run 'pod install' in ios/ directory
→ Clean and rebuild Android: './gradlew clean'
→ Clear Metro cache: 'npx react-native start --reset-cache'

=== Platform Requirements ===

iOS:
- Minimum: iOS 12.0
- Language: Swift 5.0+
- Package Manager: CocoaPods or SPM
- Xcode: 12.0+

Android:
- Minimum: API 28 (Android 9.0)
- Language: Kotlin (required)
- Build System: Gradle
- Dependencies: AndroidX, Retrofit, Material

React Native:
- Version: 0.60+ (auto-linking)
- Node: 14+
- Supports: Expo and Bare Metal
- Package: @trustarc/trustarc-react-native-consent-sdk

Flutter:
- Version: 2.0+
- Dart: 2.12+
- Platforms: iOS and Android
- Package: trustarc_consent_sdk

=== Code Examples by Use Case ===

Show consent on app first launch:
```swift
// iOS
if !UserDefaults.standard.bool(forKey: "hasSeenConsent") {
    TrustArcConsentImpl.shared.openCm()
    UserDefaults.standard.set(true, forKey: "hasSeenConsent")
}
```

```kotlin
// Android
val prefs = getSharedPreferences("app", MODE_PRIVATE)
if (!prefs.getBoolean("hasSeenConsent", false)) {
    TrustArcConsentImpl.openCm()
    prefs.edit().putBoolean("hasSeenConsent", true).apply()
}
```

Add consent button to settings:
```typescript
// React Native
function SettingsScreen() {
  return (
    <View>
      <Button
        title="Privacy Settings"
        onPress={() => TrustArcConsentImpl.openCm()}
      />
    </View>
  );
}
```

Check consent before tracking:
```dart
// Flutter
Future<void> trackEvent() async {
  final consents = await TrustArcConsentImpl.getConsentData();
  if (consents['analytics'] == true) {
    // Track analytics event
  }
}
```

=== End of Knowledge Base ===
